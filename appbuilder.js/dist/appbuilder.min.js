/*! appbuilder 2013-07-05 */
var requirejs,require,define;!function(global){function isFunction(a){return"[object Function]"===ostring.call(a)}function isArray(a){return"[object Array]"===ostring.call(a)}function each(a,b){if(a){var c;for(c=0;c<a.length&&(!a[c]||!b(a[c],c,a));c+=1);}}function eachReverse(a,b){if(a){var c;for(c=a.length-1;c>-1&&(!a[c]||!b(a[c],c,a));c-=1);}}function hasProp(a,b){return hasOwn.call(a,b)}function getOwn(a,b){return hasProp(a,b)&&a[b]}function eachProp(a,b){var c;for(c in a)if(hasProp(a,c)&&b(a[c],c))break}function mixin(a,b,c,d){return b&&eachProp(b,function(b,e){(c||!hasProp(a,e))&&(d&&"string"!=typeof b?(a[e]||(a[e]={}),mixin(a[e],b,c,d)):a[e]=b)}),a}function bind(a,b){return function(){return b.apply(a,arguments)}}function scripts(){return document.getElementsByTagName("script")}function defaultOnError(a){throw a}function getGlobal(a){if(!a)return a;var b=global;return each(a.split("."),function(a){b=b[a]}),b}function makeError(a,b,c,d){var e=new Error(b+"\nhttp://requirejs.org/docs/errors.html#"+a);return e.requireType=a,e.requireModules=d,c&&(e.originalError=c),e}function newContext(a){function b(a){var b,c;for(b=0;a[b];b+=1)if(c=a[b],"."===c)a.splice(b,1),b-=1;else if(".."===c){if(1===b&&(".."===a[2]||".."===a[0]))break;b>0&&(a.splice(b-1,2),b-=2)}}function c(a,c,d){var e,f,g,h,i,j,k,l,m,n,o,p=c&&c.split("/"),q=p,r=x.map,s=r&&r["*"];if(a&&"."===a.charAt(0)&&(c?(q=getOwn(x.pkgs,c)?p=[c]:p.slice(0,p.length-1),a=q.concat(a.split("/")),b(a),f=getOwn(x.pkgs,e=a[0]),a=a.join("/"),f&&a===e+"/"+f.main&&(a=e)):0===a.indexOf("./")&&(a=a.substring(2))),d&&r&&(p||s)){for(h=a.split("/"),i=h.length;i>0;i-=1){if(k=h.slice(0,i).join("/"),p)for(j=p.length;j>0;j-=1)if(g=getOwn(r,p.slice(0,j).join("/")),g&&(g=getOwn(g,k))){l=g,m=i;break}if(l)break;!n&&s&&getOwn(s,k)&&(n=getOwn(s,k),o=i)}!l&&n&&(l=n,m=o),l&&(h.splice(0,m,l),a=h.join("/"))}return a}function d(a){isBrowser&&each(scripts(),function(b){return b.getAttribute("data-requiremodule")===a&&b.getAttribute("data-requirecontext")===u.contextName?(b.parentNode.removeChild(b),!0):void 0})}function e(a){var b=getOwn(x.paths,a);return b&&isArray(b)&&b.length>1?(d(a),b.shift(),u.require.undef(a),u.require([a]),!0):void 0}function f(a){var b,c=a?a.indexOf("!"):-1;return c>-1&&(b=a.substring(0,c),a=a.substring(c+1,a.length)),[b,a]}function g(a,b,d,e){var g,h,i,j,k=null,l=b?b.name:null,m=a,n=!0,o="";return a||(n=!1,a="_@r"+(E+=1)),j=f(a),k=j[0],a=j[1],k&&(k=c(k,l,e),h=getOwn(C,k)),a&&(k?o=h&&h.normalize?h.normalize(a,function(a){return c(a,l,e)}):c(a,l,e):(o=c(a,l,e),j=f(o),k=j[0],o=j[1],d=!0,g=u.nameToUrl(o))),i=!k||h||d?"":"_unnormalized"+(F+=1),{prefix:k,name:o,parentMap:b,unnormalized:!!i,url:g,originalName:m,isDefine:n,id:(k?k+"!"+o:o)+i}}function h(a){var b=a.id,c=getOwn(y,b);return c||(c=y[b]=new u.Module(a)),c}function i(a,b,c){var d=a.id,e=getOwn(y,d);!hasProp(C,d)||e&&!e.defineEmitComplete?(e=h(a),e.error&&"error"===b?c(e.error):e.on(b,c)):"defined"===b&&c(C[d])}function j(a,b){var c=a.requireModules,d=!1;b?b(a):(each(c,function(b){var c=getOwn(y,b);c&&(c.error=a,c.events.error&&(d=!0,c.emit("error",a)))}),d||req.onError(a))}function k(){globalDefQueue.length&&(apsp.apply(B,[B.length-1,0].concat(globalDefQueue)),globalDefQueue=[])}function l(a){delete y[a],delete z[a]}function m(a,b,c){var d=a.map.id;a.error?a.emit("error",a.error):(b[d]=!0,each(a.depMaps,function(d,e){var f=d.id,g=getOwn(y,f);!g||a.depMatched[e]||c[f]||(getOwn(b,f)?(a.defineDep(e,C[f]),a.check()):m(g,b,c))}),c[d]=!0)}function n(){var a,b,c,f,g=1e3*x.waitSeconds,h=g&&u.startTime+g<(new Date).getTime(),i=[],k=[],l=!1,o=!0;if(!s){if(s=!0,eachProp(z,function(c){if(a=c.map,b=a.id,c.enabled&&(a.isDefine||k.push(c),!c.error))if(!c.inited&&h)e(b)?(f=!0,l=!0):(i.push(b),d(b));else if(!c.inited&&c.fetched&&a.isDefine&&(l=!0,!a.prefix))return o=!1}),h&&i.length)return c=makeError("timeout","Load timeout for modules: "+i,null,i),c.contextName=u.contextName,j(c);o&&each(k,function(a){m(a,{},{})}),h&&!f||!l||!isBrowser&&!isWebWorker||w||(w=setTimeout(function(){w=0,n()},50)),s=!1}}function o(a){hasProp(C,a[0])||h(g(a[0],null,!0)).init(a[1],a[2])}function p(a,b,c,d){a.detachEvent&&!isOpera?d&&a.detachEvent(d,b):a.removeEventListener(c,b,!1)}function q(a){var b=a.currentTarget||a.srcElement;return p(b,u.onScriptLoad,"load","onreadystatechange"),p(b,u.onScriptError,"error"),{node:b,id:b&&b.getAttribute("data-requiremodule")}}function r(){var a;for(k();B.length;){if(a=B.shift(),null===a[0])return j(makeError("mismatch","Mismatched anonymous define() module: "+a[a.length-1]));o(a)}}var s,t,u,v,w,x={waitSeconds:7,baseUrl:"./",paths:{},pkgs:{},shim:{},config:{}},y={},z={},A={},B=[],C={},D={},E=1,F=1;return v={require:function(a){return a.require?a.require:a.require=u.makeRequire(a.map)},exports:function(a){return a.usingExports=!0,a.map.isDefine?a.exports?a.exports:a.exports=C[a.map.id]={}:void 0},module:function(a){return a.module?a.module:a.module={id:a.map.id,uri:a.map.url,config:function(){var b,c=getOwn(x.pkgs,a.map.id);return b=c?getOwn(x.config,a.map.id+"/"+c.main):getOwn(x.config,a.map.id),b||{}},exports:C[a.map.id]}}},t=function(a){this.events=getOwn(A,a.id)||{},this.map=a,this.shim=getOwn(x.shim,a.id),this.depExports=[],this.depMaps=[],this.depMatched=[],this.pluginMaps={},this.depCount=0},t.prototype={init:function(a,b,c,d){d=d||{},this.inited||(this.factory=b,c?this.on("error",c):this.events.error&&(c=bind(this,function(a){this.emit("error",a)})),this.depMaps=a&&a.slice(0),this.errback=c,this.inited=!0,this.ignore=d.ignore,d.enabled||this.enabled?this.enable():this.check())},defineDep:function(a,b){this.depMatched[a]||(this.depMatched[a]=!0,this.depCount-=1,this.depExports[a]=b)},fetch:function(){if(!this.fetched){this.fetched=!0,u.startTime=(new Date).getTime();var a=this.map;return this.shim?(u.makeRequire(this.map,{enableBuildCallback:!0})(this.shim.deps||[],bind(this,function(){return a.prefix?this.callPlugin():this.load()})),void 0):a.prefix?this.callPlugin():this.load()}},load:function(){var a=this.map.url;D[a]||(D[a]=!0,u.load(this.map.id,a))},check:function(){if(this.enabled&&!this.enabling){var a,b,c=this.map.id,d=this.depExports,e=this.exports,f=this.factory;if(this.inited){if(this.error)this.emit("error",this.error);else if(!this.defining){if(this.defining=!0,this.depCount<1&&!this.defined){if(isFunction(f)){if(this.events.error&&this.map.isDefine||req.onError!==defaultOnError)try{e=u.execCb(c,f,d,e)}catch(g){a=g}else e=u.execCb(c,f,d,e);if(this.map.isDefine&&(b=this.module,b&&void 0!==b.exports&&b.exports!==this.exports?e=b.exports:void 0===e&&this.usingExports&&(e=this.exports)),a)return a.requireMap=this.map,a.requireModules=this.map.isDefine?[this.map.id]:null,a.requireType=this.map.isDefine?"define":"require",j(this.error=a)}else e=f;this.exports=e,this.map.isDefine&&!this.ignore&&(C[c]=e,req.onResourceLoad&&req.onResourceLoad(u,this.map,this.depMaps)),l(c),this.defined=!0}this.defining=!1,this.defined&&!this.defineEmitted&&(this.defineEmitted=!0,this.emit("defined",this.exports),this.defineEmitComplete=!0)}}else this.fetch()}},callPlugin:function(){var a=this.map,b=a.id,d=g(a.prefix);this.depMaps.push(d),i(d,"defined",bind(this,function(d){var e,f,k,m=this.map.name,n=this.map.parentMap?this.map.parentMap.name:null,o=u.makeRequire(a.parentMap,{enableBuildCallback:!0});return this.map.unnormalized?(d.normalize&&(m=d.normalize(m,function(a){return c(a,n,!0)})||""),f=g(a.prefix+"!"+m,this.map.parentMap),i(f,"defined",bind(this,function(a){this.init([],function(){return a},null,{enabled:!0,ignore:!0})})),k=getOwn(y,f.id),k&&(this.depMaps.push(f),this.events.error&&k.on("error",bind(this,function(a){this.emit("error",a)})),k.enable()),void 0):(e=bind(this,function(a){this.init([],function(){return a},null,{enabled:!0})}),e.error=bind(this,function(a){this.inited=!0,this.error=a,a.requireModules=[b],eachProp(y,function(a){0===a.map.id.indexOf(b+"_unnormalized")&&l(a.map.id)}),j(a)}),e.fromText=bind(this,function(c,d){var f=a.name,i=g(f),k=useInteractive;d&&(c=d),k&&(useInteractive=!1),h(i),hasProp(x.config,b)&&(x.config[f]=x.config[b]);try{req.exec(c)}catch(l){return j(makeError("fromtexteval","fromText eval for "+b+" failed: "+l,l,[b]))}k&&(useInteractive=!0),this.depMaps.push(i),u.completeLoad(f),o([f],e)}),d.load(a.name,o,e,x),void 0)})),u.enable(d,this),this.pluginMaps[d.id]=d},enable:function(){z[this.map.id]=this,this.enabled=!0,this.enabling=!0,each(this.depMaps,bind(this,function(a,b){var c,d,e;if("string"==typeof a){if(a=g(a,this.map.isDefine?this.map:this.map.parentMap,!1,!this.skipMap),this.depMaps[b]=a,e=getOwn(v,a.id))return this.depExports[b]=e(this),void 0;this.depCount+=1,i(a,"defined",bind(this,function(a){this.defineDep(b,a),this.check()})),this.errback&&i(a,"error",bind(this,this.errback))}c=a.id,d=y[c],hasProp(v,c)||!d||d.enabled||u.enable(a,this)})),eachProp(this.pluginMaps,bind(this,function(a){var b=getOwn(y,a.id);b&&!b.enabled&&u.enable(a,this)})),this.enabling=!1,this.check()},on:function(a,b){var c=this.events[a];c||(c=this.events[a]=[]),c.push(b)},emit:function(a,b){each(this.events[a],function(a){a(b)}),"error"===a&&delete this.events[a]}},u={config:x,contextName:a,registry:y,defined:C,urlFetched:D,defQueue:B,Module:t,makeModuleMap:g,nextTick:req.nextTick,onError:j,configure:function(a){a.baseUrl&&"/"!==a.baseUrl.charAt(a.baseUrl.length-1)&&(a.baseUrl+="/");var b=x.pkgs,c=x.shim,d={paths:!0,config:!0,map:!0};eachProp(a,function(a,b){d[b]?"map"===b?(x.map||(x.map={}),mixin(x[b],a,!0,!0)):mixin(x[b],a,!0):x[b]=a}),a.shim&&(eachProp(a.shim,function(a,b){isArray(a)&&(a={deps:a}),!a.exports&&!a.init||a.exportsFn||(a.exportsFn=u.makeShimExports(a)),c[b]=a}),x.shim=c),a.packages&&(each(a.packages,function(a){var c;a="string"==typeof a?{name:a}:a,c=a.location,b[a.name]={name:a.name,location:c||a.name,main:(a.main||"main").replace(currDirRegExp,"").replace(jsSuffixRegExp,"")}}),x.pkgs=b),eachProp(y,function(a,b){a.inited||a.map.unnormalized||(a.map=g(b))}),(a.deps||a.callback)&&u.require(a.deps||[],a.callback)},makeShimExports:function(a){function b(){var b;return a.init&&(b=a.init.apply(global,arguments)),b||a.exports&&getGlobal(a.exports)}return b},makeRequire:function(b,d){function e(c,f,i){var k,l,m;return d.enableBuildCallback&&f&&isFunction(f)&&(f.__requireJsBuild=!0),"string"==typeof c?isFunction(f)?j(makeError("requireargs","Invalid require call"),i):b&&hasProp(v,c)?v[c](y[b.id]):req.get?req.get(u,c,b,e):(l=g(c,b,!1,!0),k=l.id,hasProp(C,k)?C[k]:j(makeError("notloaded",'Module name "'+k+'" has not been loaded yet for context: '+a+(b?"":". Use require([])")))):(r(),u.nextTick(function(){r(),m=h(g(null,b)),m.skipMap=d.skipMap,m.init(c,f,i,{enabled:!0}),n()}),e)}return d=d||{},mixin(e,{isBrowser:isBrowser,toUrl:function(a){var d,e=a.lastIndexOf("."),f=a.split("/")[0],g="."===f||".."===f;return-1!==e&&(!g||e>1)&&(d=a.substring(e,a.length),a=a.substring(0,e)),u.nameToUrl(c(a,b&&b.id,!0),d,!0)},defined:function(a){return hasProp(C,g(a,b,!1,!0).id)},specified:function(a){return a=g(a,b,!1,!0).id,hasProp(C,a)||hasProp(y,a)}}),b||(e.undef=function(a){k();var c=g(a,b,!0),d=getOwn(y,a);delete C[a],delete D[c.url],delete A[a],d&&(d.events.defined&&(A[a]=d.events),l(a))}),e},enable:function(a){var b=getOwn(y,a.id);b&&h(a).enable()},completeLoad:function(a){var b,c,d,f=getOwn(x.shim,a)||{},g=f.exports;for(k();B.length;){if(c=B.shift(),null===c[0]){if(c[0]=a,b)break;b=!0}else c[0]===a&&(b=!0);o(c)}if(d=getOwn(y,a),!b&&!hasProp(C,a)&&d&&!d.inited){if(!(!x.enforceDefine||g&&getGlobal(g)))return e(a)?void 0:j(makeError("nodefine","No define call for "+a,null,[a]));o([a,f.deps||[],f.exportsFn])}n()},nameToUrl:function(a,b,c){var d,e,f,g,h,i,j,k,l;if(req.jsExtRegExp.test(a))k=a+(b||"");else{for(d=x.paths,e=x.pkgs,h=a.split("/"),i=h.length;i>0;i-=1){if(j=h.slice(0,i).join("/"),f=getOwn(e,j),l=getOwn(d,j)){isArray(l)&&(l=l[0]),h.splice(0,i,l);break}if(f){g=a===f.name?f.location+"/"+f.main:f.location,h.splice(0,i,g);break}}k=h.join("/"),k+=b||(/\?/.test(k)||c?"":".js"),k=("/"===k.charAt(0)||k.match(/^[\w\+\.\-]+:/)?"":x.baseUrl)+k}return x.urlArgs?k+((-1===k.indexOf("?")?"?":"&")+x.urlArgs):k},load:function(a,b){req.load(u,a,b)},execCb:function(a,b,c,d){return b.apply(d,c)},onScriptLoad:function(a){if("load"===a.type||readyRegExp.test((a.currentTarget||a.srcElement).readyState)){interactiveScript=null;var b=q(a);u.completeLoad(b.id)}},onScriptError:function(a){var b=q(a);return e(b.id)?void 0:j(makeError("scripterror","Script error for: "+b.id,a,[b.id]))}},u.require=u.makeRequire(),u}function getInteractiveScript(){return interactiveScript&&"interactive"===interactiveScript.readyState?interactiveScript:(eachReverse(scripts(),function(a){return"interactive"===a.readyState?interactiveScript=a:void 0}),interactiveScript)}var req,s,head,baseElement,dataMain,src,interactiveScript,currentlyAddingScript,mainScript,subPath,version="2.1.6",commentRegExp=/(\/\*([\s\S]*?)\*\/|([^:]|^)\/\/(.*)$)/gm,cjsRequireRegExp=/[^.]\s*require\s*\(\s*["']([^'"\s]+)["']\s*\)/g,jsSuffixRegExp=/\.js$/,currDirRegExp=/^\.\//,op=Object.prototype,ostring=op.toString,hasOwn=op.hasOwnProperty,ap=Array.prototype,apsp=ap.splice,isBrowser=!("undefined"==typeof window||!navigator||!window.document),isWebWorker=!isBrowser&&"undefined"!=typeof importScripts,readyRegExp=isBrowser&&"PLAYSTATION 3"===navigator.platform?/^complete$/:/^(complete|loaded)$/,defContextName="_",isOpera="undefined"!=typeof opera&&"[object Opera]"===opera.toString(),contexts={},cfg={},globalDefQueue=[],useInteractive=!1;if("undefined"==typeof define){if("undefined"!=typeof requirejs){if(isFunction(requirejs))return;cfg=requirejs,requirejs=void 0}"undefined"==typeof require||isFunction(require)||(cfg=require,require=void 0),req=requirejs=function(a,b,c,d){var e,f,g=defContextName;return isArray(a)||"string"==typeof a||(f=a,isArray(b)?(a=b,b=c,c=d):a=[]),f&&f.context&&(g=f.context),e=getOwn(contexts,g),e||(e=contexts[g]=req.s.newContext(g)),f&&e.configure(f),e.require(a,b,c)},req.config=function(a){return req(a)},req.nextTick="undefined"!=typeof setTimeout?function(a){setTimeout(a,4)}:function(a){a()},require||(require=req),req.version=version,req.jsExtRegExp=/^\/|:|\?|\.js$/,req.isBrowser=isBrowser,s=req.s={contexts:contexts,newContext:newContext},req({}),each(["toUrl","undef","defined","specified"],function(a){req[a]=function(){var b=contexts[defContextName];return b.require[a].apply(b,arguments)}}),isBrowser&&(head=s.head=document.getElementsByTagName("head")[0],baseElement=document.getElementsByTagName("base")[0],baseElement&&(head=s.head=baseElement.parentNode)),req.onError=defaultOnError,req.load=function(a,b,c){var d,e=a&&a.config||{};if(isBrowser)return d=e.xhtml?document.createElementNS("http://www.w3.org/1999/xhtml","html:script"):document.createElement("script"),d.type=e.scriptType||"text/javascript",d.charset="utf-8",d.async=!0,d.setAttribute("data-requirecontext",a.contextName),d.setAttribute("data-requiremodule",b),!d.attachEvent||d.attachEvent.toString&&d.attachEvent.toString().indexOf("[native code")<0||isOpera?(d.addEventListener("load",a.onScriptLoad,!1),d.addEventListener("error",a.onScriptError,!1)):(useInteractive=!0,d.attachEvent("onreadystatechange",a.onScriptLoad)),d.src=c,currentlyAddingScript=d,baseElement?head.insertBefore(d,baseElement):head.appendChild(d),currentlyAddingScript=null,d;if(isWebWorker)try{importScripts(c),a.completeLoad(b)}catch(f){a.onError(makeError("importscripts","importScripts failed for "+b+" at "+c,f,[b]))}},isBrowser&&eachReverse(scripts(),function(a){return head||(head=a.parentNode),dataMain=a.getAttribute("data-main"),dataMain?(mainScript=dataMain,cfg.baseUrl||(src=mainScript.split("/"),mainScript=src.pop(),subPath=src.length?src.join("/")+"/":"./",cfg.baseUrl=subPath),mainScript=mainScript.replace(jsSuffixRegExp,""),req.jsExtRegExp.test(mainScript)&&(mainScript=dataMain),cfg.deps=cfg.deps?cfg.deps.concat(mainScript):[mainScript],!0):void 0}),define=function(a,b,c){var d,e;"string"!=typeof a&&(c=b,b=a,a=null),isArray(b)||(c=b,b=null),!b&&isFunction(c)&&(b=[],c.length&&(c.toString().replace(commentRegExp,"").replace(cjsRequireRegExp,function(a,c){b.push(c)}),b=(1===c.length?["require"]:["require","exports","module"]).concat(b))),useInteractive&&(d=currentlyAddingScript||getInteractiveScript(),d&&(a||(a=d.getAttribute("data-requiremodule")),e=contexts[d.getAttribute("data-requirecontext")])),(e?e.defQueue:globalDefQueue).push([a,b,c])},define.amd={jQuery:!0},req.exec=function(text){return eval(text)},req(cfg)}}(this),define("../lib/require",function(){}),define("text",["module"],function(a){var b,c,d,e,f=["Msxml2.XMLHTTP","Microsoft.XMLHTTP","Msxml2.XMLHTTP.4.0"],g=/^\s*<\?xml(\s)+version=[\'\"](\d)*.(\d)*[\'\"](\s)*\?>/im,h=/<body[^>]*>\s*([\s\S]+)\s*<\/body>/im,i="undefined"!=typeof location&&location.href,j=i&&location.protocol&&location.protocol.replace(/\:/,""),k=i&&location.hostname,l=i&&(location.port||void 0),m={},n=a.config&&a.config()||{};return b={version:"2.0.7",strip:function(a){if(a){a=a.replace(g,"");var b=a.match(h);b&&(a=b[1])}else a="";return a},jsEscape:function(a){return a.replace(/(['\\])/g,"\\$1").replace(/[\f]/g,"\\f").replace(/[\b]/g,"\\b").replace(/[\n]/g,"\\n").replace(/[\t]/g,"\\t").replace(/[\r]/g,"\\r").replace(/[\u2028]/g,"\\u2028").replace(/[\u2029]/g,"\\u2029")},createXhr:n.createXhr||function(){var a,b,c;if("undefined"!=typeof XMLHttpRequest)return new XMLHttpRequest;if("undefined"!=typeof ActiveXObject)for(b=0;3>b;b+=1){c=f[b];try{a=new ActiveXObject(c)}catch(d){}if(a){f=[c];break}}return a},parseName:function(a){var b,c,d,e=!1,f=a.indexOf("."),g=0===a.indexOf("./")||0===a.indexOf("../");return-1!==f&&(!g||f>1)?(b=a.substring(0,f),c=a.substring(f+1,a.length)):b=a,d=c||b,f=d.indexOf("!"),-1!==f&&(e="strip"===d.substring(f+1),d=d.substring(0,f),c?c=d:b=d),{moduleName:b,ext:c,strip:e}},xdRegExp:/^((\w+)\:)?\/\/([^\/\\]+)/,useXhr:function(a,c,d,e){var f,g,h,i=b.xdRegExp.exec(a);return i?(f=i[2],g=i[3],g=g.split(":"),h=g[1],g=g[0],!(f&&f!==c||g&&g.toLowerCase()!==d.toLowerCase()||(h||g)&&h!==e)):!0},finishLoad:function(a,c,d,e){d=c?b.strip(d):d,n.isBuild&&(m[a]=d),e(d)},load:function(a,c,d,e){if(e.isBuild&&!e.inlineText)return d(),void 0;n.isBuild=e.isBuild;var f=b.parseName(a),g=f.moduleName+(f.ext?"."+f.ext:""),h=c.toUrl(g),m=n.useXhr||b.useXhr;!i||m(h,j,k,l)?b.get(h,function(c){b.finishLoad(a,f.strip,c,d)},function(a){d.error&&d.error(a)}):c([g],function(a){b.finishLoad(f.moduleName+"."+f.ext,f.strip,a,d)})},write:function(a,c,d){if(m.hasOwnProperty(c)){var e=b.jsEscape(m[c]);d.asModule(a+"!"+c,"define(function () { return '"+e+"';});\n")}},writeFile:function(a,c,d,e,f){var g=b.parseName(c),h=g.ext?"."+g.ext:"",i=g.moduleName+h,j=d.toUrl(g.moduleName+h)+".js";b.load(i,d,function(){var c=function(a){return e(j,a)};c.asModule=function(a,b){return e.asModule(a,j,b)},b.write(a,i,c,f)},f)}},"node"===n.env||!n.env&&"undefined"!=typeof process&&process.versions&&process.versions.node?(c=require.nodeRequire("fs"),b.get=function(a,b,d){try{var e=c.readFileSync(a,"utf8");0===e.indexOf("﻿")&&(e=e.substring(1)),b(e)}catch(f){d(f)}}):"xhr"===n.env||!n.env&&b.createXhr()?b.get=function(a,c,d,e){var f,g=b.createXhr();if(g.open("GET",a,!0),e)for(f in e)e.hasOwnProperty(f)&&g.setRequestHeader(f.toLowerCase(),e[f]);n.onXhr&&n.onXhr(g,a),g.onreadystatechange=function(){var b,e;4===g.readyState&&(b=g.status,b>399&&600>b?(e=new Error(a+" HTTP status: "+b),e.xhr=g,d(e)):c(g.responseText),n.onXhrComplete&&n.onXhrComplete(g,a))},g.send(null)}:"rhino"===n.env||!n.env&&"undefined"!=typeof Packages&&"undefined"!=typeof java?b.get=function(a,b){var c,d,e="utf-8",f=new java.io.File(a),g=java.lang.System.getProperty("line.separator"),h=new java.io.BufferedReader(new java.io.InputStreamReader(new java.io.FileInputStream(f),e)),i="";try{for(c=new java.lang.StringBuffer,d=h.readLine(),d&&d.length()&&65279===d.charAt(0)&&(d=d.substring(1)),null!==d&&c.append(d);null!==(d=h.readLine());)c.append(g),c.append(d);i=String(c.toString())}finally{h.close()}b(i)}:("xpconnect"===n.env||!n.env&&"undefined"!=typeof Components&&Components.classes&&Components.interfaces)&&(d=Components.classes,e=Components.interfaces,Components.utils["import"]("resource://gre/modules/FileUtils.jsm"),b.get=function(a,b){var c,f,g={},h=new FileUtils.File(a);try{c=d["@mozilla.org/network/file-input-stream;1"].createInstance(e.nsIFileInputStream),c.init(h,1,0,!1),f=d["@mozilla.org/intl/converter-input-stream;1"].createInstance(e.nsIConverterInputStream),f.init(c,"utf-8",c.available(),e.nsIConverterInputStream.DEFAULT_REPLACEMENT_CHARACTER),f.readString(c.available(),g),f.close(),c.close(),b(g.value)}catch(i){throw new Error((h&&h.path||"")+": "+i)}}),b}),define("text!appbuilder.html",[],function(){return'<div class="webmaker-appbuilder-connection-sentence">\n  <div>\n    When <select data-output-action></select>, <select data-input-action></select>.\n  </div>\n  <div>\n    <button data-action="accept">Connect</button><button data-action="cancel">Cancel</button>\n  </div>\n</div>\n<div class="webmaker-appbuilder-connection-list">\n  <ul>\n    <li class="connection-details">\n      <input type="checkbox" checked="checked">\n      <label data-description></label>\n    </li>\n  </ul>\n  <div>\n    <button data-action="accept">Save</button><button data-action="cancel">Cancel</button>\n  </div>\n</div>'}),define("text!appbuilder.css",[],function(){return".webmaker-appbuilder-connection-sentence {\n  visibility: hidden;\n  position: fixed;\n  top: 0;\n  width: 100%;\n  text-align: center;\n  background-color: rgba(30, 30, 30, 0.85);\n  color: #fff;\n  padding: 5px;\n  z-index: 9999;\n}\n\n.webmaker-appbuilder-connection-sentence.on {\n  visibility: visible;\n}\n\n.webmaker-appbuilder-connection-list {\n  visibility: hidden;\n  position: fixed;\n  top: 0;\n  width: 100%;\n  text-align: center;\n  background-color: rgba(30, 30, 30, 0.85);\n  color: #fff;\n  padding: 5px;\n  z-index: 9999;\n}\n\n.webmaker-appbuilder-connection-list.on {\n  visibility: visible;\n}\n\n.webmaker-appbuilder-connection-list ul {\n  list-style: none;\n}\n"}),define("ui-util",[],function(){return{getDomFragmentFromString:function(a){var b=document.createElement("div");return b.innerHTML=a,b},attachCSSFromString:function(a){var b=document.createElement("style");b.innerHTML=a,document.head.appendChild(b)}}}),define("text!graph-ui.css",[],function(){return'.webmaker-appbuilder-overlay {\n  position: absolute;\n  z-index: 9999;\n  background: rgba(60, 150, 250, 0.7);\n  opacity: 0;\n}\n\n.webmaker-appbuilder-overlay.on {\n  opacity: 1;\n}\n\n.webmaker-appbuilder-line {\n  -webkit-transform-origin: 5px 5px;\n     -moz-transform-origin: 5px 5px;\n      -ms-transform-origin: 5px 5px;\n       -o-transform-origin: 5px 5px;\n          transform-origin: 5px 5px;\n  position: absolute;\n  z-index: 9999;\n  border: 5px solid rgba(60, 250, 150, 0.8);\n  pointer-events: none;\n  margin-top: -2.5px;\n  margin-left: -2.5px;\n  border-top-left-radius: 5px;\n  border-bottom-left-radius: 5px;\n}\n\n.webmaker-appbuilder-line:after {\n  right: -35px;\n  border: solid transparent;\n  content: " ";\n  height: 0;\n  width: 0;\n  position: absolute;\n  pointer-events: none;\n  border-width: 15px;\n  top: 50%;\n  margin-top: -15px;\n  border-left-color: rgba(170, 220, 250, 0.8);\n}'}),define("text!graph-ui.html",[],function(){return'<div class="webmaker-appbuilder-line"></div>\n<div class="webmaker-appbuilder-overlay"></div>\n'}),define("graph-ui",["text!graph-ui.css","text!graph-ui.html","ui-util"],function(a,b,c){function d(a,b){function c(){var c=f-a,d=g-b,h=Math.sqrt(c*c+d*d),i=180*Math.atan2(d,c)/Math.PI;e.style.width=h+"px";var j="rotate("+i.toFixed(3)+"deg)";e.style.transform=j,e.style.WebkitTransform=j,e.style.MozTransform=j}function d(a){f=a.clientX+document.body.scrollLeft,g=a.clientY+document.body.scrollTop,c()}var e=j.querySelector(".webmaker-appbuilder-line").cloneNode(!0),f=a,g=b;return e.style.left=a+"px",e.style.top=b+"px",window.addEventListener("mousemove",d,!1),e.stop=function(){window.removeEventListener("mousemove",d,!1)},c(),e}function e(a){function b(){d.classList.add("on"),f=a}function c(){d.classList.remove("on"),f=null}var d=j.querySelector(".webmaker-appbuilder-overlay").cloneNode(!0),e=setInterval(function(){var b=a.getBoundingClientRect();d.style.top=b.top+document.body.scrollTop+"px",d.style.left=b.left+document.body.scrollLeft+"px",d.style.width=b.width+"px",d.style.height=b.height+"px"},20);return d.addEventListener("mouseover",b,!1),d.addEventListener("mouseout",c,!1),d.turnOn=function(){d.classList.add("on")},d.stop=function(){clearInterval(e),d.removeEventListener("mouseover",b,!1),d.removeEventListener("mouseout",c,!1)},a._appbuilder.overlay=d,d}var f=null,g=[],h=[],i=null,j=c.getDomFragmentFromString(b);c.attachCSSFromString(a);var k={addElement:function(a,b){function c(d){function e(){window.removeEventListener("mouseup",e,!1),a.addEventListener("mousedown",c,!1),clearTimeout(g)}function f(){window.removeEventListener("mouseup",f,!1),a.addEventListener("mousedown",c,!1);var d=k.stopDrawingPath();k.destroyOverlays(),d&&b.onConnectionRequest(d)}if(1!==d.which)return!0;var g=-1,h=d.clientX,i=d.clientY;g=setTimeout(function(){window.removeEventListener("mouseup",e,!1),window.addEventListener("mouseup",f,!1),k.createOverlays(),k.startDrawingPath(h+document.body.scrollLeft,i+document.body.scrollTop),g=-1,d.preventDefault(),d.stopPropagation()},500),window.addEventListener("mouseup",e,!1),a.removeEventListener("mousedown",c,!1)}return b=b||{},b.onConnectionRequest=b.onConnectionRequest||function(){},g.push(a),{enable:function(){a.addEventListener("mousedown",c,!1)},disable:function(){a.removeEventListener("mousedown",c,!1)}}},removeElement:function(a){var b=g.indexOf(a);b>-1&&g.splice(b,1)},createOverlays:function(){g.forEach(function(a){var b=e(a);document.body.appendChild(b),h.push(b)})},destroyOverlays:function(){for(;h.length>0;){var a=h.shift();a.stop(),a.parentNode.removeChild(a)}},createSpecificOverlay:function(a){var b=e(a);document.body.appendChild(b),b.classList.add("on"),h.push(b)},destroySpecificOverlay:function(a){a.classList.contains("webmaker-appbuilder-overlay")||(a=a._appbuilder.overlay),a.stop(),a.parentNode.removeChild(a);var b=h.indexOf(a);b>-1&&h.splice(b,1)},startDrawingPath:function(a,b){i=d(a,b),document.body.appendChild(i);for(var c=document.elementFromPoint(a,b);c&&!c._appbuilder;)c=c.parentNode;c&&(f=c,f._appbuilder.overlay.turnOn())},stopDrawingPath:function(){i.stop(),document.body.removeChild(i);var a=f;return f=null,a}};return k}),define("events",[],function(){function a(){var a="EventNamespace"+b++;return{on:function(b,c){var d=a+b;document.addEventListener(d,c,!1)},off:function(b,c){var d=a+b;document.removedEventListener(d,c,!1)},dispatch:function(b,c){var d=document.createEvent("CustomEvent"),e=a+b;d.initCustomEvent(e,!1,!1,c),document.dispatchEvent(d)}}}var b=0;return{createEventManager:a}}),define("text!connection.html",[],function(){return"<appbuilder-connection data-appbuilder-connection></appbuilder-connection>"}),define("connections",["ui-util","text!connection.html"],function(a,b){function c(a,b,c,d){this.inputEndpoint=c,this.outputEndpoint=a,this.inputType=d,this.outputType=b;var f=this.element=e.querySelector("*[data-appbuilder-connection]").cloneNode(!0);f.setAttribute("to","#"+c._parent.name),f.setAttribute("from","#"+a._parent.name),f.setAttribute("input",d),f.setAttribute("output",b),this.send=function(a){c.receive(d,a)},this.addToDOM=function(){document.body.appendChild(this.element)},this.removeFromDOM=function(){document.body.removeChild(this.element)}}function d(a,b){var c={},d={},e={_parent:a,getOutputConnections:function(){return c},getInputConnections:function(){return d},getOutputConnection:function(a,b,d){var e=c[a];if(e){var f;return e.forEach(function(a){a.inputEndpoint===b&&a.inputType===d&&(f=a)}),f}return null},addInputConnection:function(a){d[a.inputType]=d[a.inputType]||[],d[a.inputType].push(a)},addOutputConnection:function(a){c[a.outputType]=c[a.outputType]||[],c[a.outputType].push(a)},removeInputConnection:function(a){var b=d[a.inputType];if(b){var c=b.indexOf(a);c>-1&&b.splice(c,1)}},removeOutputConnection:function(a){var b=c[a.outputType];if(b){var d=b.indexOf(a);d>-1&&b.splice(d,1)}},send:function(a,b){if(f){var d=c[a];d&&d.forEach(function(a){a.send(b)})}},receive:b};return e}var e,f=!0;return{init:function(){e=a.getDomFragmentFromString(b)},setActive:function(a){f=!!a},createEndpoint:d,createConnection:function(a,b,d,e){return new c(a,b,d,e)}}}),define("element",["graph-ui","events","connections"],function(a,b,c){var d=0;return{create:function(e,f,g){var h={};g=g||{},h.modes=f.modes||{},h.events=b.createEventManager(),h.connections=c.createEndpoint(h,function(a,b){h.events.dispatch("receive:"+a,b)}),e.id=e.id||"appbuilder-element-"+d++,h.name=e.name||e.getAttribute("name")||e.id||e.tagName,h.definition=f,h.states=f.states||{},h.edit=f.edit,h.onInput=function(a,b){h.events.on("receive:"+a,function(a){b(a.data||a.detail)})},h.offInput=function(){},h.sendOutput=function(a,b){h.connections.send(a,b)},h.connectOutput=function(a,b,d){var e=c.createConnection(h.connections,a,b.connections,d);h.connections.addOutputConnection(e),b.connections.addInputConnection(e),h.events.dispatch("connect",{to:b,type:a,connection:e}),e.addToDOM()},h.findAndDisconnectOutput=function(a,b,c){var d=h.connections.getOutputConection(a,from,c);d&&(h.removeOutputConnection(d),b.connections.removeInputConnection(d)),h.events.dispatch("disconnect",b),d.removeFromDOM()},h.disconnectOutput=function(a){h.connections.removeOutputConnection(a),a.inputEndpoint.removeInputConnection(a),a.removeFromDOM()};var i=a.addElement(e,{onConnectionRequest:g.onConnectionRequest});return h.enableGraphMouseEvents=function(){i.enable()},h.disableGraphMouseEvents=function(){i.disable()},h}}}),define("appbuilder",["text!appbuilder.html","text!appbuilder.css","ui-util","graph-ui","events","connections","element"],function(a,b,c,d,e,f,g){function h(a,b,c){function d(){var a=Array.prototype.slice.call(i.querySelectorAll('input[type="checkbox"]')).filter(function(a){return!a.checked}).map(function(a){return a._connection});b&&b(a)}function e(){c&&c()}var f=p.querySelector('button[data-action="accept"]'),g=p.querySelector('button[data-action="cancel"]'),h=a._appbuilder.definition.outputs,i=p.querySelector("ul"),j=a._appbuilder.connections.getOutputConnections();i.innerHTML="";var k=[],l=0;Object.keys(j).forEach(function(b){j[b].forEach(function(c){var d=c.inputEndpoint._parent.definition.inputs[c.inputType].description,e=h[b].description;d=d.replace("{{name}}","the "+a._appbuilder.name),e=e.replace("{{name}}","the "+c.inputEndpoint._parent.name);var f=q.cloneNode(!0),g=f.querySelector("*[data-description]"),j=f.querySelector('input[type="checkbox"]');j.id="appbuilder-connection-list-item-"+l,g.innerHTML="When "+e+", "+d,g.setAttribute("for","appbuilder-connection-list-item-"+l),j._connection=c,i.appendChild(f),k.push(c),++l})}),k.length>0&&(p.classList.add("on"),f.addEventListener("click",d,!1),g.addEventListener("click",e,!1));var m={clear:function(){f.removeEventListener("click",d,!1),g.removeEventListener("click",e,!1),p.classList.remove("on")}};return m}function i(a,b,c,e){function f(){d.createSpecificOverlay(b)}function g(){d.createSpecificOverlay(a)}function h(){d.destroySpecificOverlay(b)}function i(){d.destroySpecificOverlay(a)}function j(a,b,c){Object.keys(b).forEach(function(d){var e=b[d],f=document.createElement("option"),g=e.description.replace("{{name}}","the "+c);f.appendChild(document.createTextNode(g)),f.title=""+d+" ("+e.type+")",f.value=d,a.appendChild(f)})}function k(){c&&c(p.value,q.value)}function l(){e&&e()}var m=a._appbuilder,n=b._appbuilder,p=o.querySelector("*[data-output-action]"),q=o.querySelector("*[data-input-action]"),r=o.querySelector('button[data-action="accept"]'),s=o.querySelector('button[data-action="cancel"]');
p.innerHTML="",q.innerHTML="",j(p,m.definition.outputs,m.name),j(q,n.definition.inputs,n.name),q.addEventListener("mouseover",f,!1),p.addEventListener("mouseover",g,!1),q.addEventListener("mouseout",h,!1),p.addEventListener("mouseout",i,!1),r.addEventListener("click",k,!1),s.addEventListener("click",l,!1);var t={clear:function(){q.removeEventListener("mouseover",f,!1),p.removeEventListener("mouseover",g,!1),q.removeEventListener("mouseout",h,!1),p.removeEventListener("mouseout",i,!1),r.removeEventListener("click",k,!1),s.removeEventListener("click",l,!1),o.classList.remove("on")}};return o.classList.add("on"),t}function j(a){var b=a.currentTarget;s&&s.clear(),s=h(b,function(a){a.forEach(function(a){b._appbuilder.disconnectOutput(a)}),s.clear()},function(){s.clear()})}function k(a){var b;for(b=a.parentNode;b&&-1===m.indexOf(b);)b=b.parentNode;if(b||a.hasAttribute("from")&&(b=document.querySelector(a.getAttribute("from"))),b){var c=a.getAttribute("to"),d=a.getAttribute("out"),e=a.getAttribute("in"),f=document.querySelector(c);f&&d&&e&&f._appbuilder&&b._appbuilder.connectOutput(d,f._appbuilder,e)}a.parentNode.removeChild(a)}function l(){n=c.getDomFragmentFromString(a),o=n.querySelector(".webmaker-appbuilder-connection-sentence").cloneNode(!0),p=n.querySelector(".webmaker-appbuilder-connection-list").cloneNode(!0),q=p.querySelector(".connection-details"),document.body.appendChild(o),document.body.appendChild(p),q.parentNode.removeChild(q),window.addEventListener("appbuilderloaded",function(){setTimeout(function(){var a=Array.prototype.slice.call(document.querySelectorAll("appbuilder-connection")).concat(t);a.forEach(k)},100)},!1),f.init(),u=!0;var b=document.createEvent("CustomEvent");b.initCustomEvent("appbuilderloaded",!1,!1,v),window.dispatchEvent(b)}var m=[];c.attachCSSFromString(b);var n,o,p,q,r,s,t=[],u=!1,v=window.appbuilder=window.appbuilder||{},w={inactive:function(){v.disableGraphMouseEvents(),f.setActive(!1)},connect:function(){v.enableGraphMouseEvents(),f.setActive(!1)},interactive:function(){v.disableGraphMouseEvents(),f.setActive(!0)}};return v.switchMode=function(a){if(!w[a])throw"No such appbuilder mode: "+a;w[a](),m.forEach(function(b){b._appbuilder.modes[a]&&b._appbuilder.modes[a]()})},v.createElementOverlays=function(){d.createOverlays()},v.updateStateListenersOnConnect=function(a){a.events.on("connect",function(b){Object.keys(a.states).forEach(function(c){b.detail.type===c&&a.states[c]&&b.detail.connection.send()})})},v.enableGraphMouseEvents=function(){m.forEach(function(a){a._appbuilder.enableGraphMouseEvents(),a.addEventListener("click",j,!1)})},v.disableGraphMouseEvents=function(){m.forEach(function(a){a._appbuilder.disableGraphMouseEvents(),a.removeEventListener("click",j,!1)})},v.forEachElement=function(a){m.forEach(a)},v.ready=function(a){u?setTimeout(function(){a()},10):window.addEventListener("appbuilderloaded",function b(){window.removeEventListener("appbuilderloaded",b,!1),a()},!1)},v.initElement=function(a,b){if(b=b||a._appbuilder,!b)throw"No definition found for element.";return a._appbuilder=g.create(a,b,{onConnectionRequest:function(b){r&&r.clear(),r=i(a,b,function(c,e){a._appbuilder.connectOutput(c,b._appbuilder,e),d.destroyOverlays(),r.clear(),r=null},function(){d.destroyOverlays(),r.clear(),r=null})}}),m.push(a),b.connectionElements&&b.connectionElements.length&&"string"!=typeof b.connectionElements&&Array.prototype.slice.call(b.connectionElements).forEach(function(b){var c=a.id?"#"+a.id:a.name?a.tagName+'[name="'+a.name+'"]':"";b.setAttribute("from",c),t.push(b)}),a._appbuilder},document.body&&["complete","interactive"].indexOf(document.readyState>-1)?setTimeout(l,100):document.addEventListener("DOMContentLoaded",l,!1),v}),require(["appbuilder"]);